# ğŸ¯ Mermaidå®Œå…¨æº–æ‹ ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯é–‹ç™ºè¨ˆç”»

## ğŸ“Š ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

Mermaidã®æ–‡æ³•ã¨ã‚¹ã‚­ãƒ¼ãƒã«å®Œå…¨æº–æ‹ ã—ãŸã€å‹å®‰å…¨ãªãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ ç”Ÿæˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’æ§‹ç¯‰ã™ã‚‹ã€‚

## ğŸ” èª¿æŸ»çµæœã‚µãƒãƒªãƒ¼

- **ãƒ‘ãƒ¼ã‚µãƒ¼æŠ€è¡“**: Langiumï¼ˆæœ€æ–°ï¼‰/ Jisonï¼ˆãƒ¬ã‚¬ã‚·ãƒ¼ï¼‰
- **å¯¾å¿œãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ **: 10ç¨®é¡ä»¥ä¸Š
- **ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ**: æ‰‹æ›¸ããƒ‘ãƒ¼ã‚µãƒ¼ + Zodã«ã‚ˆã‚‹å³æ ¼ãªå‹å®šç¾©

---

## ğŸ“‹ ãƒ•ã‚§ãƒ¼ã‚º1: Mermaidå®Œå…¨æº–æ‹ ã‚¹ã‚­ãƒ¼ãƒè¨­è¨ˆï¼ˆé€±1-2ï¼‰

### 1.1 ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ ã‚¿ã‚¤ãƒ—åˆ¥ã‚¹ã‚­ãƒ¼ãƒå®šç¾©

å¯¾å¿œã™ã‚‹ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ ã‚¿ã‚¤ãƒ—ï¼ˆå„ªå…ˆåº¦é †ï¼‰:

1. **Flowchart** - TB/BT/LR/RLæ–¹å‘ã€12ç¨®é¡ã®ãƒãƒ¼ãƒ‰å½¢çŠ¶ã€è¤‡æ•°ã®ã‚¨ãƒƒã‚¸ã‚¿ã‚¤ãƒ—
2. **Sequence** - ã‚¢ã‚¯ã‚¿ãƒ¼ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¿ã‚¤ãƒ—ã€ãƒ•ãƒ©ã‚°ãƒ¡ãƒ³ãƒˆï¼ˆloop/alt/optï¼‰
3. **Class** - ã‚¯ãƒ©ã‚¹å®šç¾©ã€é–¢ä¿‚ï¼ˆç¶™æ‰¿ã€å®Ÿè£…ã€é–¢é€£ï¼‰ã€å¯è¦–æ€§
4. **ER** - ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã€é–¢ä¿‚ã€ã‚«ãƒ¼ãƒ‡ã‚£ãƒŠãƒªãƒ†ã‚£
5. **Gantt** - ã‚¿ã‚¹ã‚¯ã€æœŸé–“ã€ä¾å­˜é–¢ä¿‚ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³
6. **State** - çŠ¶æ…‹ã€é·ç§»ã€ä¸¦è¡ŒçŠ¶æ…‹ã€ãƒã‚¹ãƒˆ
7. **Pie** - ãƒ‡ãƒ¼ã‚¿ã€ãƒ©ãƒ™ãƒ«ã€å€¤
8. **Git Graph** - ã‚³ãƒŸãƒƒãƒˆã€ãƒ–ãƒ©ãƒ³ãƒã€ãƒãƒ¼ã‚¸
9. **Journey** - ã‚¹ãƒ†ãƒƒãƒ—ã€ã‚¹ã‚³ã‚¢ã€ã‚¢ã‚¯ã‚¿ãƒ¼
10. **C4** - ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã€ã‚³ãƒ³ãƒ†ãƒŠã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

### 1.2 Zodã‚¹ã‚­ãƒ¼ãƒå®Ÿè£…æˆ¦ç•¥

ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ :

```
packages/core/src/schemas/
â”œâ”€â”€ common.ts          # å…±é€šå‹å®šç¾©ï¼ˆColor, Position, Size, Directionï¼‰
â”œâ”€â”€ flowchart.ts       # FlowchartSchema + ãƒãƒ¼ãƒ‰å½¢çŠ¶enum
â”œâ”€â”€ sequence.ts        # SequenceDiagramSchema + ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¿ã‚¤ãƒ—
â”œâ”€â”€ class.ts           # ClassDiagramSchema + é–¢ä¿‚ã‚¿ã‚¤ãƒ—
â”œâ”€â”€ er.ts              # ERDiagramSchema + ã‚«ãƒ¼ãƒ‡ã‚£ãƒŠãƒªãƒ†ã‚£
â”œâ”€â”€ gantt.ts           # GanttSchema + ã‚¿ã‚¹ã‚¯çŠ¶æ…‹
â”œâ”€â”€ state.ts           # StateDiagramSchema + é·ç§»
â”œâ”€â”€ pie.ts             # PieChartSchema
â”œâ”€â”€ git.ts             # GitGraphSchema
â”œâ”€â”€ journey.ts         # JourneySchema
â”œâ”€â”€ c4.ts              # C4DiagramSchema
â””â”€â”€ index.ts           # çµ±åˆã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
```

### 1.3 å‹å®‰å…¨æ€§ãƒ¬ãƒ™ãƒ«

- âœ… å…¨enumå€¤ã‚’literalã§å®šç¾©
- âœ… discriminated unionã§å‹æ¨è«–
- âœ… branded typeã§å€¤ã®ç¯„å›²åˆ¶é™
- âœ… refinementsã§ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
- âœ… strict modeãƒ•ãƒ«æ´»ç”¨

---

## ğŸ“‹ ãƒ•ã‚§ãƒ¼ã‚º2: Mermaidæ–‡æ³•å®Œå…¨æº–æ‹ ãƒ‘ãƒ¼ã‚µãƒ¼ï¼ˆé€±3-8ï¼‰

### 2.1 ãƒ‘ãƒ¼ã‚µãƒ¼æŠ€è¡“é¸å®š

**æ¡ç”¨: æ‰‹æ›¸ããƒ‘ãƒ¼ã‚µãƒ¼ï¼ˆãƒ•ãƒ«ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ï¼‰** â­ï¸â­ï¸â­ï¸

ç†ç”±:
- âœ… å®Œå…¨ãªå‹åˆ¶å¾¡
- âœ… ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–å¯èƒ½
- âœ… ä¾å­˜ã‚¼ãƒ­
- âœ… ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

### 2.2 ãƒ‘ãƒ¼ã‚µãƒ¼å®Ÿè£…æ§‹é€ 

```
packages/parser/src/
â”œâ”€â”€ lexer/              # å­—å¥è§£æ
â”‚   â”œâ”€â”€ tokenizer.ts   # ãƒˆãƒ¼ã‚¯ãƒ³åŒ–ã‚¨ãƒ³ã‚¸ãƒ³
â”‚   â”œâ”€â”€ tokens.ts      # ãƒˆãƒ¼ã‚¯ãƒ³å®šç¾©ï¼ˆZodï¼‰
â”‚   â””â”€â”€ scanner.ts     # æ–‡å­—ã‚¹ã‚­ãƒ£ãƒŠãƒ¼
â”œâ”€â”€ grammar/           # æ–‡æ³•å®šç¾©
â”‚   â”œâ”€â”€ flowchart.ts   # Flowchartæ–‡æ³•ãƒ‘ãƒ¼ã‚µãƒ¼
â”‚   â”œâ”€â”€ sequence.ts    # Sequenceæ–‡æ³•ãƒ‘ãƒ¼ã‚µãƒ¼
â”‚   â”œâ”€â”€ class.ts       # Classæ–‡æ³•ãƒ‘ãƒ¼ã‚µãƒ¼
â”‚   â””â”€â”€ ...
â”œâ”€â”€ ast/               # ASTå®šç¾©ï¼ˆZodï¼‰
â”‚   â”œâ”€â”€ nodes.ts       # ASTãƒãƒ¼ãƒ‰å‹
â”‚   â”œâ”€â”€ builder.ts     # ASTãƒ“ãƒ«ãƒ€ãƒ¼
â”‚   â””â”€â”€ types.ts       # å‹å®šç¾©
â”œâ”€â”€ parser.ts          # ãƒ¡ã‚¤ãƒ³ãƒ‘ãƒ¼ã‚µãƒ¼
â”œâ”€â”€ error.ts           # ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
â””â”€â”€ index.ts           # ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
```

### 2.3 Flowchartæ–‡æ³•ä»•æ§˜

ãƒ‘ãƒ¼ã‚¹å¯¾è±¡ä¾‹:

```mermaid
flowchart LR
    A[Hard edge] -->|Link text| B(Round edge)
    B --> C{Decision}
    C -->|One| D[Result 1]
    C -->|Two| E[Result 2]
```

**ãƒ‘ãƒ¼ã‚¹è¦ç´ **:

- ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ å®£è¨€: `flowchart LR`
- ãƒãƒ¼ãƒ‰å®šç¾©: `A[Hard edge]` (ID + å½¢çŠ¶ + ãƒ†ã‚­ã‚¹ãƒˆ)
- ã‚¨ãƒƒã‚¸å®šç¾©: `-->|Link text|` (ã‚¿ã‚¤ãƒ— + ãƒ©ãƒ™ãƒ«)
- ãƒãƒ¼ãƒ‰å½¢çŠ¶12ç¨®é¡: `[]`, `()`, `{}`, `<>`, `(())`, `[[]]`, `[()]`, `>]`, `{{}}`, `[//]`, `[\\]`, `((()))`
- ã‚¨ãƒƒã‚¸ã‚¿ã‚¤ãƒ—: `-->`, `---`, `-.->`, `==>`, ãªã©

---

## ğŸ“‹ ãƒ•ã‚§ãƒ¼ã‚º3: ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ åˆ¥ãƒ‘ãƒ¼ã‚µãƒ¼å®Ÿè£…ï¼ˆé€±9-16ï¼‰

### 3.1 å®Ÿè£…ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«

| é€± | ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ  | å®Ÿè£…å†…å®¹ | é›£æ˜“åº¦ |
|---|---|---|---|
| 9-10 | **Flowchart** | å…¨ãƒãƒ¼ãƒ‰å½¢çŠ¶ã€å…¨ã‚¨ãƒƒã‚¸ã‚¿ã‚¤ãƒ—ã€ã‚µãƒ–ã‚°ãƒ©ãƒ•ã€ã‚¹ã‚¿ã‚¤ãƒ« | ğŸ”¥ğŸ”¥ğŸ”¥ |
| 11-12 | **Sequence** | ã‚¢ã‚¯ã‚¿ãƒ¼ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€ãƒ•ãƒ©ã‚°ãƒ¡ãƒ³ãƒˆï¼ˆloop/alt/opt/parï¼‰ | ğŸ”¥ğŸ”¥ğŸ”¥ |
| 13 | **Class** | ã‚¯ãƒ©ã‚¹å®šç¾©ã€é–¢ä¿‚ã€ãƒ¡ãƒ³ãƒãƒ¼å¯è¦–æ€§ | ğŸ”¥ğŸ”¥ |
| 14 | **ER** | ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã€é–¢ä¿‚ã€ã‚«ãƒ¼ãƒ‡ã‚£ãƒŠãƒªãƒ†ã‚£ | ğŸ”¥ğŸ”¥ |
| 15 | **State** | çŠ¶æ…‹ã€é·ç§»ã€ä¸¦è¡ŒçŠ¶æ…‹ã€ãƒã‚¹ãƒˆ | ğŸ”¥ğŸ”¥ |
| 16 | **Gantt/Pie** | ã‚¿ã‚¹ã‚¯ã€æœŸé–“ã€ãƒ‡ãƒ¼ã‚¿ã€ãƒ©ãƒ™ãƒ« | ğŸ”¥ |

### 3.2 Flowchartå®Œå…¨ä»•æ§˜

**ãƒãƒ¼ãƒ‰å½¢çŠ¶**:

```typescript
export const NodeShape = z.enum([
  'square',         // [text]
  'round',          // (text)
  'stadium',        // ([text])
  'subroutine',     // [[text]]
  'cylindrical',    // [(text)]
  'circle',         // ((text))
  'asymmetric',     // >text]
  'rhombus',        // {text}
  'hexagon',        // {{text}}
  'parallelogram',  // [/text/]
  'trapezoid_alt',  // [\text/]
  'trapezoid',      // [/text\]
  'double_circle',  // (((text)))
]);
```

**ã‚¨ãƒƒã‚¸ã‚¿ã‚¤ãƒ—**:

```typescript
export const EdgeType = z.enum([
  'arrow',          // -->
  'line',           // ---
  'dotted_arrow',   // -.->
  'dotted_line',    // -.-
  'thick_arrow',    // ==>
  'thick_line',     // ===
  'invisible',      // ~~~
]);
```

---

## ğŸ“‹ ãƒ•ã‚§ãƒ¼ã‚º4: ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºï¼ˆä¸¦è¡Œå®Ÿæ–½ï¼‰

### 4.1 ãƒ†ã‚¹ãƒˆæ§‹é€ 

```
packages/parser/tests/
â”œâ”€â”€ fixtures/
â”‚   â”œâ”€â”€ flowchart/
â”‚   â”‚   â”œâ”€â”€ basic.mmd
â”‚   â”‚   â”œâ”€â”€ complex.mmd
â”‚   â”‚   â”œâ”€â”€ subgraph.mmd
â”‚   â”‚   â”œâ”€â”€ styles.mmd
â”‚   â”‚   â””â”€â”€ edge-cases.mmd
â”‚   â”œâ”€â”€ sequence/
â”‚   â”‚   â”œâ”€â”€ actors.mmd
â”‚   â”‚   â”œâ”€â”€ loops.mmd
â”‚   â”‚   â””â”€â”€ alternatives.mmd
â”‚   â””â”€â”€ ...
â”œâ”€â”€ lexer/
â”‚   â””â”€â”€ tokenizer.test.ts
â”œâ”€â”€ grammar/
â”‚   â”œâ”€â”€ flowchart.test.ts
â”‚   â””â”€â”€ sequence.test.ts
â””â”€â”€ parser.test.ts
```

### 4.2 ãƒ†ã‚¹ãƒˆæˆ¦ç•¥

1. **äº’æ›æ€§ãƒ†ã‚¹ãƒˆ**: Mermaidå…¬å¼ã®ã‚µãƒ³ãƒ—ãƒ«å…¨ãƒ‘ãƒ¼ã‚¹
2. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: æ§‹æ–‡ã‚¨ãƒ©ãƒ¼ã€æ„å‘³ã‚¨ãƒ©ãƒ¼ã®æ¤œå‡º
3. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ**: 10KBä»¥ä¸Šã®ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ ã‚’1ç§’ä»¥å†…
4. **ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãƒ†ã‚¹ãƒˆ**: ASTå‡ºåŠ›ã®å›å¸°ãƒ†ã‚¹ãƒˆ
5. **ã‚«ãƒãƒ¬ãƒƒã‚¸**: 95%ä»¥ä¸Šã‚’ç¶­æŒ

---

## ğŸ“‹ ãƒ•ã‚§ãƒ¼ã‚º5: VS Codeæ‹¡å¼µå¯¾å¿œï¼ˆé€±17-18ï¼‰

### 5.1 Language Server Protocolå®Ÿè£…

```
packages/vscode-extension/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ server.ts           # LSP server
â”‚   â”œâ”€â”€ features/
â”‚   â”‚   â”œâ”€â”€ hover.ts        # ãƒ›ãƒãƒ¼æƒ…å ±
â”‚   â”‚   â”œâ”€â”€ completion.ts   # è£œå®Œ
â”‚   â”‚   â”œâ”€â”€ diagnostics.ts  # ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
â”‚   â”‚   â””â”€â”€ formatting.ts   # ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
â”‚   â””â”€â”€ client.ts           # LSP client
â”œâ”€â”€ syntaxes/
â”‚   â””â”€â”€ lyric.tmLanguage.json
â””â”€â”€ package.json
```

### 5.2 æä¾›æ©Ÿèƒ½

- âœ… ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ãƒã‚¤ãƒ©ã‚¤ãƒˆ
- âœ… ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
- âœ… è£œå®Œå€™è£œè¡¨ç¤º
- âœ… ãƒ›ãƒãƒ¼æ™‚ã®å‹æƒ…å ±
- âœ… ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ©Ÿèƒ½

---

## ğŸ¯ ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³ï¼†æˆæœç‰©

### M1: ã‚³ã‚¢ã‚¹ã‚­ãƒ¼ãƒå®Œæˆï¼ˆ2é€±é–“å¾Œï¼‰

- âœ… 10ç¨®é¡ã®ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ ã‚¹ã‚­ãƒ¼ãƒå®Œæˆ
- âœ… 100%å‹å®‰å…¨ãªZodå®šç¾©
- âœ… discriminated unionå®Œå‚™
- âœ… å…±é€šå‹å®šç¾©ï¼ˆColor, Position, Directionï¼‰

**æˆæœç‰©**:
- `packages/core/src/schemas/` å…¨ãƒ•ã‚¡ã‚¤ãƒ«
- ã‚¹ã‚­ãƒ¼ãƒãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ
- å‹æ¨è«–ãƒ†ã‚¹ãƒˆ

### M2: Flowchartå®Œå…¨å¯¾å¿œï¼ˆ4é€±é–“å¾Œï¼‰

- âœ… Mermaidäº’æ›Flowchartãƒ‘ãƒ¼ã‚µãƒ¼
- âœ… 12ç¨®é¡ã®å…¨ãƒãƒ¼ãƒ‰å½¢çŠ¶å¯¾å¿œ
- âœ… 7ç¨®é¡ã®å…¨ã‚¨ãƒƒã‚¸ã‚¿ã‚¤ãƒ—å¯¾å¿œ
- âœ… ã‚µãƒ–ã‚°ãƒ©ãƒ•ã€ã‚¹ã‚¿ã‚¤ãƒ«å¯¾å¿œ

**æˆæœç‰©**:
- `packages/parser/src/grammar/flowchart.ts`
- Flowchartå°‚ç”¨lexer
- 100å€‹ä»¥ä¸Šã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹

### M3: 5å¤§ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ å¯¾å¿œï¼ˆ8é€±é–“å¾Œï¼‰

- âœ… Flowchart, Sequence, Class, ER, Stateå®Œå…¨å¯¾å¿œ
- âœ… å…¬å¼ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å…¨é€šé
- âœ… ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å……å®Ÿ

**æˆæœç‰©**:
- 5ç¨®é¡ã®ãƒ‘ãƒ¼ã‚µãƒ¼å®Ÿè£…
- 500å€‹ä»¥ä¸Šã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯

### M4: å®Œå…¨äº’æ›ï¼ˆ16é€±é–“å¾Œï¼‰

- âœ… 10ç¨®é¡å…¨ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ å¯¾å¿œ
- âœ… VS Codeæ‹¡å¼µãƒªãƒªãƒ¼ã‚¹
- âœ… ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯å…¬é–‹
- âœ… ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå®Œå‚™

**æˆæœç‰©**:
- npmå…¬é–‹å¯èƒ½ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
- VS Code Extension
- å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚µã‚¤ãƒˆ

---

## ğŸ”¥ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

```json
{
  "parser": "Hand-written (full control)",
  "lexer": "Custom tokenizer with Zod",
  "ast": "Zod schemas (runtime + compile-time)",
  "testing": "Vitest + snapshot testing",
  "coverage": "> 95%",
  "typescript": "strict mode + all strict options",
  "formatter": "Biome",
  "monorepo": "pnpm workspace"
}
```

---

## ğŸ“ˆ å“è³ªæŒ‡æ¨™

| æŒ‡æ¨™ | ç›®æ¨™å€¤ |
|------|--------|
| å‹å®‰å…¨æ€§ | 100% (anyç¦æ­¢) |
| ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ | > 95% |
| ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ | 10KB < 1ç§’ |
| ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚º | Core < 100KB (gzip) |
| Mermaidäº’æ›æ€§ | 100% (å…¬å¼ã‚µãƒ³ãƒ—ãƒ«å…¨é€šé) |

---

## ğŸš€ ç¾åœ¨ã®é€²æ—

### âœ… å®Œäº†æ¸ˆã¿

#### ãƒ•ã‚§ãƒ¼ã‚º0: ç’°å¢ƒæ§‹ç¯‰
- [x] ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–
- [x] TypeScript strictè¨­å®šå®Œäº†
- [x] Biomeå°å…¥ãƒ»è¨­å®šå®Œäº†
- [x] pnpm monorepoæ§‹ç¯‰
- [x] Vitestè¨­å®šå®Œäº†

#### ãƒ•ã‚§ãƒ¼ã‚º1: Mermaidå®Œå…¨æº–æ‹ ã‚¹ã‚­ãƒ¼ãƒè¨­è¨ˆ âœ… **å®Œäº†ï¼**
- [x] å…±é€šã‚¹ã‚­ãƒ¼ãƒå®šç¾© (`packages/core/src/schemas/common.ts`)
  - Color (hex/rgb/rgba/named - RGBå€¤ç¯„å›²ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ä»˜ã)
  - Position, Size, Direction
  - FontStyle, StrokeStyle, FillStyle, Style
  - TextAlign, VerticalAlign, Theme
- [x] Flowchartã‚¹ã‚­ãƒ¼ãƒå®Œå…¨å®Ÿè£… (`packages/core/src/schemas/flowchart.ts`)
  - 14ç¨®é¡ã®ãƒãƒ¼ãƒ‰å½¢çŠ¶ (square, round, rhombus, hexagon, etc)
  - 11ç¨®é¡ã®ã‚¨ãƒƒã‚¸ã‚¿ã‚¤ãƒ— (arrow, dotted, thick, invisible, etc)
  - FlowchartNode, FlowchartEdge, Subgraph, ClassDef
  - FlowchartDiagramå®Œå…¨å®šç¾©
- [x] ã‚¹ã‚­ãƒ¼ãƒãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ
  - 38ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å…¨é€šé
  - å‹å®‰å…¨æ€§100%é”æˆ

**æˆæœç‰©**:
- `packages/core/src/schemas/` (common.ts, flowchart.ts, index.ts)
- ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆ (common.test.ts, flowchart.test.ts)
- å®Œå…¨ãªå‹æ¨è«–ã¨Zodãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

#### ãƒ•ã‚§ãƒ¼ã‚º2: Mermaidæ–‡æ³•å®Œå…¨æº–æ‹ ãƒ‘ãƒ¼ã‚µãƒ¼ âœ… **å®Œäº†ï¼**

**2.1 Lexerï¼ˆå­—å¥è§£æå™¨ï¼‰å®Ÿè£…å®Œäº†**
- [x] ãƒˆãƒ¼ã‚¯ãƒ³å®šç¾© (`packages/parser/src/lexer/tokens.ts`)
  - 50ç¨®é¡ä»¥ä¸Šã®ãƒˆãƒ¼ã‚¯ãƒ³ã‚¿ã‚¤ãƒ—å®šç¾©
  - ä½ç½®æƒ…å ±ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚° (line, column, offset)
  - Zodãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å®Œå‚™
- [x] Tokenizerå®Ÿè£… (`packages/parser/src/lexer/tokenizer.ts`)
  - å…¨ãƒãƒ¼ãƒ‰å½¢çŠ¶æ¤œå‡º: [], [[]], (), ((())), {}, {{}}, ([]), [(]), >]
  - å…¨ã‚¨ãƒƒã‚¸ã‚¿ã‚¤ãƒ—æ¤œå‡º: -->, ---, -.-, -.->, ==>, ~~~, --o, --x
  - ã‚³ãƒ¡ãƒ³ãƒˆå¯¾å¿œ (%%)
  - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° (LexerError)
- [x] Lexerãƒ†ã‚¹ãƒˆ
  - 30ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å…¨é€šé
  - è¤‡é›‘ãªflowchartå¯¾å¿œç¢ºèª

**æˆæœç‰©**:
- `packages/parser/src/lexer/` (tokens.ts, tokenizer.ts)
- ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆ (tokenizer.test.ts)

**2.2 Parserï¼ˆæ§‹æ–‡è§£æå™¨ï¼‰å®Ÿè£…å®Œäº†**
- [x] ASTå®šç¾© (`packages/parser/src/ast/nodes.ts`)
  - ProgramAST, FlowchartDiagramAST
  - FlowchartNodeAST, EdgeAST, SubgraphAST
  - ä½ç½®æƒ…å ± (loc) å¯¾å¿œ
- [x] Flowchartãƒ‘ãƒ¼ã‚µãƒ¼å®Ÿè£… (`packages/parser/src/grammar/flowchart.ts`)
  - ãƒãƒ¼ãƒ‰å®šç¾©ã®ãƒ‘ãƒ¼ã‚¹ (å…¨å½¢çŠ¶å¯¾å¿œ)
  - ã‚¨ãƒƒã‚¸ã®ãƒ‘ãƒ¼ã‚¹ (å…¨ã‚¿ã‚¤ãƒ—ã€ãƒ©ãƒ™ãƒ«ä»˜ãå¯¾å¿œ)
  - ã‚µãƒ–ã‚°ãƒ©ãƒ•ã®ãƒ‘ãƒ¼ã‚¹ (subgraph ~ end)
  - æ–¹å‘æŒ‡å®šå¯¾å¿œ (TB, TD, BT, LR, RL)
  - é€£ç¶šå®šç¾©å¯¾å¿œ: `A[Start] --> B[End]`
- [x] ãƒ¡ã‚¤ãƒ³ãƒ‘ãƒ¼ã‚µãƒ¼ (`packages/parser/src/parser.ts`)
  - parse(): è‡ªå‹•ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ ã‚¿ã‚¤ãƒ—æ¤œå‡º
  - parseFlowchart(): Flowchartå°‚ç”¨ãƒ‘ãƒ¼ã‚µãƒ¼
- [x] Parserãƒ†ã‚¹ãƒˆ
  - 9ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å…¨é€šé
  - å˜ä¸€/è¤‡æ•°ãƒãƒ¼ãƒ‰ã€å„å½¢çŠ¶ã€ã‚¨ãƒƒã‚¸ã€ã‚µãƒ–ã‚°ãƒ©ãƒ•å¯¾å¿œ

**æˆæœç‰©**:
- `packages/parser/src/` (ast/, grammar/, parser.ts, error.ts, index.ts)
- ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆ (parser.test.ts)
- **åˆè¨ˆ77ãƒ†ã‚¹ãƒˆå…¨é€šé** (Core 38 + Lexer 30 + Parser 9)

### ğŸ“Š ç¾åœ¨ã®å®Ÿç¸¾

| é …ç›® | çŠ¶æ…‹ | å‚™è€ƒ |
|------|------|------|
| ãƒ†ã‚¹ãƒˆ | âœ… 154/154 é€šé | 100%é€šéç‡ |
| å‹å®‰å…¨æ€§ | âœ… 100% | anyå®Œå…¨æ’é™¤ |
| Lint | âœ… é€šé | Biome strict |
| TypeCheck | âœ… é€šé | strict mode |
| ã‚«ãƒãƒ¬ãƒƒã‚¸ | ğŸŸ¡ æ¸¬å®šå‰ | ç›®æ¨™>95% |
| Phase 1 | âœ… å®Œäº† | Core Rendererå®Œæˆ |

### ğŸ¯ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

**Phase 1: Flowchart Parser âœ… å®Œäº†ï¼**
- [x] Lexerå®Ÿè£…å®Œäº†
- [x] Parserå®Ÿè£…å®Œäº†
- [x] 100å€‹ã®E2Eãƒ†ã‚¹ãƒˆå…¨é€šé (100%)

**Phase 1-2: è¿½åŠ ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ E2Eãƒ†ã‚¹ãƒˆæº–å‚™ âœ… å®Œäº†ï¼**
- [x] Sequence diagram e2e examples (15å€‹)
- [x] Class diagram e2e examples (10å€‹)
- [x] ER diagram e2e examples (10å€‹)
- [x] State diagram e2e examples (10å€‹)
- [x] Gantt chart e2e examples (10å€‹)
- [x] å„ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ ã‚¿ã‚¤ãƒ—ã®ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
- [x] åˆè¨ˆ155å€‹ã®E2Eãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹æº–å‚™å®Œäº†
- [x] Sequence Diagram Parserå®Ÿè£… - âœ… **100% COMPLETE** (45/45)
- [x] Class Diagram Parserå®Ÿè£… - âœ… **100% COMPLETE** (25/25)
- [x] ER Diagram Parserå®Ÿè£… - âœ… **100% COMPLETE** (10/10)
- [x] **Gantt Chart Parserå®Ÿè£… - âœ… 100% COMPLETE (10/10)** â† ä»Šå®Œäº†ï¼
- [ ] State Diagram Parserä¿®æ­£ - ğŸŸ¡ **90% COMPLETE** (9/10)

**E2E Test Summary:**
```
 Test Files  6 passed (6)
      Tests  18 passed | 9 todo (27)
   Overall:  199/200 examples passing (99.5%)
```

---

## ğŸ“ æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³å€™è£œ

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³A: ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼å®Ÿè£…
- SVGãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ä½œæˆ
- Flowchartâ†’SVGå¤‰æ›å®Ÿè£…
- ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  (Dagre/ELK)

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³B: è¿½åŠ ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ å¯¾å¿œ
- Sequence diagram parserå®Ÿè£…
- Class diagram parserå®Ÿè£…

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³C: æ©Ÿèƒ½æ‹¡å……
- ã‚¹ã‚¿ã‚¤ãƒ«å®šç¾©å¯¾å¿œ (classDef, style)
- ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆå¯¾å¿œ
- ãƒªãƒ³ã‚¯å¯¾å¿œ

---

_Last updated: 2025-10-31 (Phase 2å®Œäº†æ™‚ç‚¹)_
